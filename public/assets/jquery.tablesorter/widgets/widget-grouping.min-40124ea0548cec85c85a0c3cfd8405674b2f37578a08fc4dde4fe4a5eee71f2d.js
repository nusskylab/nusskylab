!function(r){"use strict";var e=r.tablesorter;e.grouping={types:{number:function(r,o,t,u,p){var n,a;return u>1&&""!==t?o.hasClass(e.css.sortAsc)?(n=Math.floor(parseFloat(t)/u)*u,n>parseFloat(p||0)?n:parseFloat(p||0)):(n=Math.ceil(parseFloat(t)/u)*u,n<parseFloat(p||u)-n?parseFloat(p||u)-n:n):(a=(t+"").match(/\d+/g),a&&a.length>=u?a[u-1]:t||"")},separator:function(e,o,t,u){var p=(t+"").split(e.widgetOptions.group_separator);return r.trim(p&&u>0&&p.length>=u?p[(u||1)-1]:"")},word:function(r,e,o,t){var u=(o+" ").match(/\w+/g);return u&&u.length>=t?u[t-1]:o||""},letter:function(r,e,o,t){return o?(o+" ").substring(0,t):""},date:function(r,e,o,t){var u=r.widgetOptions,p=new Date(o||""),n=p.getHours();return"year"===t?p.getFullYear():"month"===t?u.group_months[p.getMonth()]:"monthyear"===t?u.group_months[p.getMonth()]+" "+p.getFullYear():"day"===t?u.group_months[p.getMonth()]+" "+p.getDate():"week"===t?u.group_week[p.getDay()]:"time"===t?("00"+(n>12?n-12:0===n?n+12:n)).slice(-2)+":"+("00"+p.getMinutes()).slice(-2)+" "+("00"+u.group_time[n>=12?1:0]).slice(-2):u.group_dateString(p)}},update:function(o,t,u){if(!r.isEmptyObject(t.cache)){var p,n,a,g,s,l,i,c,d,_="undefined"!=typeof t.sortList[0],h="",f=0,b=!1,m="undefined"!=typeof u.group_forceColumn[0]?u.group_enforceSort&&!_?-1:u.group_forceColumn[0]:_?t.sortList[0][0]:-1;if(t.$table.find("tr.group-hidden").removeClass("group-hidden").end().find("tr.group-header").remove(),u.group_collapsible&&t.$table.data("pagerSavedHeight",0),m>=0&&m<t.columns&&!t.$headerIndexed[m].hasClass("group-false")){for(u.group_currentGroup="",u.group_currentGroups={},s=(t.$headerIndexed[m].attr("class")||"").match(/(group-\w+(-\w+)?)/g),l=s?s[0].split("-"):["group","letter",1],u.group_collapsible&&u.group_saveGroups&&e.storage&&(u.group_currentGroups=e.storage(o,"tablesorter-groups")||{},d="dir"+t.sortList[0][1],c=u.group_currentGroup=""+t.sortList[0][0]+d+l.join(""),u.group_currentGroups[c]?b=!0:u.group_currentGroups[c]=[]),n=0;n<t.$tbodies.length;n++)for(i=t.cache[n].normalized,h="",g=t.$tbodies.eq(n).children("tr").not("."+t.cssChildRow),p=0;p<g.length;p++)g.eq(p).is(":visible")&&e.grouping.types[l[1]]&&(a=i[p]?e.grouping.types[l[1]](t,t.$headerIndexed[m],i[p][m],/date/.test(s)?l[2]:parseInt(l[2]||1,10)||1,h):a,h!==a&&(h=a,"number"===l[1]&&l[2]>1&&""!==a&&(a+=" - "+(parseInt(a,10)+(parseInt(l[2],10)-1)*(t.$headerIndexed[m].hasClass(e.css.sortAsc)?1:-1))),r.isFunction(u.group_formatter)&&(a=u.group_formatter((a||"").toString(),m,o,t,u)||a),g.eq(p).before('<tr class="group-header '+t.selectorRemove.slice(1)+'" unselectable="on" '+(t.tabIndex?'tabindex="0" ':"")+'data-group-index="'+f+++'"><td colspan="'+t.columns+'">'+(u.group_collapsible?"<i/>":"")+'<span class="group-name">'+a+'</span><span class="group-count"></span></td></tr>'),u.group_saveGroups&&!b&&u.group_collapsed&&u.group_collapsible&&u.group_currentGroups[u.group_currentGroup].push(a)));t.$table.find("tr.group-header").bind("selectstart",!1).each(function(){var e,t,p,n=r(this),a=n.nextUntil("tr.group-header").filter(":visible");(u.group_count||r.isFunction(u.group_callback))&&(t=n.find(".group-count"),t.length&&(u.group_count&&t.html(u.group_count.replace(/\{num\}/g,a.length)),r.isFunction(u.group_callback)&&u.group_callback(n.find("td"),a,m,o))),u.group_saveGroups&&!r.isEmptyObject(u.group_currentGroups)&&u.group_currentGroups[u.group_currentGroup].length?(p=n.find(".group-name").text().toLowerCase()+n.attr("data-group-index"),e=r.inArray(p,u.group_currentGroups[u.group_currentGroup])>-1,n.toggleClass("collapsed",e),a.toggleClass("group-hidden",e)):u.group_collapsed&&u.group_collapsible&&(n.addClass("collapsed"),a.addClass("group-hidden"))}),t.$table.trigger(u.group_complete)}}},bindEvents:function(o,t,u){u.group_collapsible&&(u.group_currentGroups=[],t.$table.on("click toggleGroup keyup","tr.group-header",function(p){if(p.stopPropagation(),"keyup"!==p.type||13===p.which){var n,a,g=r(this),s=g.find(".group-name").text().toLowerCase()+g.attr("data-group-index");!p.shiftKey||"click"!==p.type&&"keyup"!==p.type||g.siblings(".group-header").trigger("toggleGroup"),g.toggleClass("collapsed"),g.nextUntil("tr.group-header").toggleClass("group-hidden",g.hasClass("collapsed")),u.group_saveGroups&&e.storage&&(t.$table.find(".group-header"),n=g.hasClass("collapsed"),u.group_currentGroups[u.group_currentGroup]||(u.group_currentGroups[u.group_currentGroup]=[]),n&&u.group_currentGroup?u.group_currentGroups[u.group_currentGroup].push(s):u.group_currentGroup&&(a=r.inArray(s,u.group_currentGroups[u.group_currentGroup]))>-1&&u.group_currentGroups[u.group_currentGroup].splice(a,1),e.storage(o,"tablesorter-groups",u.group_currentGroups))}})),r(u.group_saveReset).on("click",function(){e.grouping.clearSavedGroups(o)}),t.$table.on("pagerChange.tsgrouping",function(){e.grouping.update(o,t,u)})},clearSavedGroups:function(r){r&&e.storage&&(e.storage(r,"tablesorter-groups",""),e.grouping.update(r,r.config,r.config.widgetOptions))}},e.addWidget({id:"group",priority:100,options:{group_collapsible:!0,group_collapsed:!1,group_saveGroups:!0,group_saveReset:null,group_count:" ({num})",group_separator:"-",group_formatter:null,group_callback:null,group_complete:"groupingComplete",group_forceColumn:[],group_enforceSort:!0,group_checkbox:["checked","unchecked"],group_months:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],group_week:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],group_time:["AM","PM"],group_dateString:function(r){return r.toLocaleString()}},init:function(r,o,t,u){e.grouping.bindEvents(r,t,u)},format:function(r,o,t){e.grouping.update(r,o,t)},remove:function(r,e){e.$table.off("click","tr.group-header").off("pagerChange.tsgrouping").find(".group-hidden").removeClass("group-hidden").end().find("tr.group-header").remove()}})}(jQuery);