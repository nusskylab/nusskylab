!function(t){"use strict";var e=t.tablesorter,o=e.output={event:"outputTable",regexQuote:/([\n\t\x09\x0d\x0a]|<[^<]+>)/,regexBR:/(<br([\s\/])?>|\n)/g,regexIMG:/<img[^>]+alt\s*=\s*['"]([^'"]+)['"][^>]*>/i,regexHTML:/<[^<]+>/g,replaceCR:"\r\n",replaceTab:"\t",popupTitle:"Output",popupStyle:"width:100%;height:100%;",message:"Your device does not support downloading. Please try again in desktop browser.",init:function(t){t.$table.off(o.event).on(o.event,function(e){e.stopPropagation(),o.process(t,t.widgetOptions)})},processRow:function(u,n,r,a){var p,i,l,s,c,d,f,w,_,h,g=u.widgetOptions,m=[],v=g.output_duplicateSpans,b=r&&a&&g.output_headerRows&&t.isFunction(g.output_callbackJSON),y=0,R=n.length;for(s=0;R>s;s++)for(m[s]||(m[s]=[]),y=0,i=n.eq(s).children(),l=i.length,f=0;l>f;f++){if(p=i.eq(f),p.filter("[rowspan]").length)for(w=parseInt(p.attr("rowspan"),10)-1,h=o.formatData(u,g,p,r),c=1;w>=c;c++)m[s+c]||(m[s+c]=[]),m[s+c][y]=r?h:v?h:"";if(p.filter("[colspan]").length)for(_=parseInt(p.attr("colspan"),10)-1,h=o.formatData(u,g,p,r),d=1;_>=d;d++)if(p.filter("[rowspan]").length)for(w=parseInt(p.attr("rowspan"),10),c=0;w>c;c++)m[s+c]||(m[s+c]=[]),m[s+c][y+d]=b?g.output_callbackJSON(p,h,y+d)||h+"("+(y+d)+")":r?h:v?h:"";else m[s][y+d]=b?g.output_callbackJSON(p,h,y+d)||h+"("+(y+d)+")":r?h:v?h:"";for(;"undefined"!=typeof m[s][y];)y++;m[s][y]=m[s][y]||o.formatData(u,g,p,r),y++}return e.output.removeColumns(u,g,m)},removeColumns:function(t,e,o){var u,n,r,a=[],p=o.length;for(u=0;p>u;u++)for(n=o[u],a[u]=[],r=0;r<t.columns;r++)e.output_hiddenColumnArray[r]||a[u].push(n[r]);return a},process:function(u,n){var r,a,p,i,l,s,c,d,f=window.JSON&&JSON.hasOwnProperty("stringify"),w=0,_=(n.output_separator||",").toLowerCase(),h="json"===_,g="array"===_,m=h||g?",":n.output_separator,v=n.output_saveRows,b=u.$table;for(n.output_regex=new RegExp("("+(/\\/.test(m)?"\\":"")+m+")"),n.output_hiddenColumnArray=[],w=0;w<u.columns;w++)n.output_hiddenColumnArray[w]=t.inArray(w,n.output_ignoreColumns)>-1||!n.output_hiddenColumns&&"none"===u.$headerIndexed[w].css("display")&&!u.$headerIndexed[w].hasClass("tablesorter-scroller-hidden-column");if(a=b.find("thead tr").not("."+(e.css.filterRow||"tablesorter-filter-row")).filter(function(){return n.output_hiddenColumns||"none"!==t(this).css("display")}),i=o.processRow(u,a,!0,h),p=b.children("tbody").children("tr"),p=/^f/.test(v)?p.not("."+(n.filter_filteredRow||"filtered")):/^v/.test(v)?p.filter(":visible"):/^[.#:\[]/.test(v)?p.filter(v):p,l=o.processRow(u,p),n.output_includeFooter&&(l=l.concat(o.processRow(u,b.children("tfoot").children("tr:visible")))),s=i.length,h){for(_=[],c=l.length,w=0;c>w;w++)d=i[s>1&&n.output_headerRows?w%s:s-1],_.push(o.row2Hash(d,l[w]));r=f?JSON.stringify(_):_}else d=[i[s>1&&n.output_headerRows?w%s:s-1]],_=o.row2CSV(n,n.output_headerRows?i:d,g).concat(o.row2CSV(n,l,g)),r=g&&f?JSON.stringify(_):_.join("\n");(!t.isFunction(n.output_callback)||n.output_callback(u,r))&&(/p/i.test(n.output_delivery||"")?o.popup(r,n.output_popupStyle,h||g):o.download(n,r))},row2CSV:function(t,e,o){var u,n,r=[],a=e.length;for(n=0;a>n;n++)u=(e[n]||[]).join("").replace(/\"/g,""),(e[n]||[]).length>0&&""!==u&&(r[r.length]=o?e[n]:e[n].join(t.output_separator));return r},row2Hash:function(t,e){var o,u={},n=e.length;for(o=0;n>o;o++)o<t.length&&(u[t[o]]=e[o]);return u},formatData:function(e,u,n,r){var a=n.attr(u.output_dataAttrib),p=void 0!==a?a:n.html(),i=(u.output_separator||",").toLowerCase(),l="json"===i||"array"===i,s=p.replace(/\"/g,u.output_replaceQuote||"\u201c");return s=u.output_trimSpaces?s.replace(o.regexBR,""):s.replace(o.regexBR,o.replaceCR).replace(/\t/g,o.replaceTab),p=s.match(o.regexIMG),u.output_includeHTML||null===p||(s=p[1]),s=u.output_includeHTML&&!r?s:s.replace(o.regexHTML,""),s=u.output_trimSpaces||r?t.trim(s):s,i=!l&&(u.output_wrapQuotes||u.output_regex.test(s)||o.regexQuote.test(s)),s=i?'"'+s+'"':s,"function"==typeof u.output_formatContent?u.output_formatContent(e,u,{isHeader:r,$cell:n,content:s}):s},popup:function(t,e,u){var n=window.open("",o.popupTitle,e);return n.document.write("<html><head><title>"+o.popupTitle+'</title></head><body><textarea wrap="'+(u?"on":"off")+'" style="'+o.popupStyle+'">'+t+"\n</textarea></body></html>"),n.document.close(),n.focus(),!0},download:function(t,e){var u,n,r,a=window.navigator,p=document.createElement("a");if(/(iP)/g.test(a.userAgent))return alert(o.message),!1;try{r=!!new Blob}catch(t){r=!1}return r?(window.URL=window.URL||window.webkitURL,n=new Blob(["\ufeff",e],{type:t.output_encoding}),a.msSaveBlob?a.msSaveBlob(n,t.output_saveFileName):(p.href=window.URL.createObjectURL(n),p.download=t.output_saveFileName,document.createEvent&&(u=document.createEvent("MouseEvents"),u.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),p.dispatchEvent(u))),!1):(window.open(t.output_encoding+encodeURIComponent(e)+"?download","_self"),!0)},remove:function(t){t.$table.off(o.event)}};e.addWidget({id:"output",options:{output_separator:",",output_ignoreColumns:[],output_hiddenColumns:!1,output_includeFooter:!1,output_dataAttrib:"data-name",output_headerRows:!1,output_delivery:"popup",output_saveRows:"filtered",output_duplicateSpans:!0,output_replaceQuote:"\u201c;",output_includeHTML:!1,output_trimSpaces:!0,output_wrapQuotes:!1,output_popupStyle:"width=500,height=300",output_saveFileName:"mytable.csv",output_formatContent:null,output_callback:function(){return!0},output_callbackJSON:function(t,e,o){return e+"("+o+")"},output_encoding:"data:application/octet-stream;charset=utf8,"},init:function(t,e,u){o.init(u)},remove:function(t,e){o.remove(e)}})}(jQuery);