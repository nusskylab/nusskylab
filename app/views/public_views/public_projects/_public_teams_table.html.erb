<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>3 Col Portfolio - Start Bootstrap Template</title>
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>
  <!-- Page Header -->
  <div class="row">
      <div class="col-lg-12">
          <h1 class="page-header">Project List
              <small><%= locals[:selected_teams].length %> teams (<%= number_to_percentage(100.0 * locals[:selected_teams].length.to_f / locals[:teams].length.to_f, precision: 0) %> of the cohort)</small>
          </h1>
      </div>
  </div>
  
  <div class="row">
  <% locals[:selected_teams].each_with_index do |team, idx| %>
    <!-- The Project Profile -->
    <div class="card col-sm-12 col-md-6 col-lg-4 border-0">
      <div class="card-body">
        <a role="button" onclick="createModalBox(<%= team.team_name %>)" id="button_<%= team.team_name %>">
          <% if !team.poster_link.blank? %>
            <%= link_to image_tag(team.poster_link, size: "200", alt: "Team's Poster Link is not in image form",
              title: "Click to view an enlarged version of this image.", id: "img_#{team.team_name}", onerror: "onerror=null;replaceImg(this, '#{team.project_level}')"), team.poster_link %>
          <% elsif locals[:selected_type] == 'Vostok' %>
            <%= image_tag("Vostok_Icon.jpg", size: "200", class: 'rounded inactive_link') %>
          <% elsif locals[:selected_type] == 'Project Gemini' %>
            <%= image_tag("Project_Gemini_Icon.png", size: "200", class: 'rounded inactive_link') %>
          <% elsif locals[:selected_type] == 'Apollo 11' %>
            <%= image_tag("Apollo_11_Icon.png", size: "200", class: 'rounded inactive_link') %>
          <% end %>
        </a>
        <!-- createModalBox(<%= team.team_name %>) disabled if no submission present -->
        <!-- this assumes that submission has valid poster and video links -->
        <h3 class="card-title"> <%= idx + 1 %>. <strong><%= team.team_name %></strong> </h3>
        <p class="card-text text-muted">Students: <%= team.students.map{|student| student.user.user_name}.join(' & ') %></p>
        <p class="card-text text-muted">Advised by: <%= team.adviser ? team.adviser.user.user_name : 'Not assigned' %></p>
      </div>
      <div class="card-footer bg-white border-top-0">
        <% submission_local = Submission.where(team_id: team.id)[-1] %>    
        <button data-toggle="modal" data-target="#modal_<%= team.id %>" class="btn btn-primary button_team text-center" id="button_<%= team.id %>" <% if (!submission_local) %> disabled <% end %>>
          View submission
        </button>
      </div>
    </div>
    <!-- ToDo: data for Modal Box is initialized even though the button is disabled. Inefficient loading page.-->
    <!-- The Modal Box -->
    <div id="modal_<%= team.id %>" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="modal_<%= team.id %>Label" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h4 class="modal-title text-muted"><%= team.team_name %></h4>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <h4 class="text-muted">Submission Links:</h4>
            <div class="row">
              <% if (submission_local) %>
                <% if (!submission_local.video_link.blank?) %>
                  <div class="col-md-6">
                    <a role="button" class="btn btn-info" href="<%= Submission.where(team_id: team.id)[-1].video_link %>">
                      Watch Project Video
                    </a>
                  </div>
                <% else %>
                  <div>Video link is not submitted / not available.</div>
                <% end %>
                <% if (!submission_local.poster_link.blank?) %>
                  <div class="col-md-6">
                    <a role="button" class="btn btn-info" href="<%= Submission.where(team_id: team.id)[-1].poster_link %>">
                      View Project Poster
                    </a>
                  </div>
                <% else %>
                  <div>Poster link is not submitted / not available.</div>
                <% end %>
              <% else %>
                <div>There is no submission available to be shown.</div>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    </div>
  <% end %>
  </div>
  
  <!-- Projects Row -->
</body>
